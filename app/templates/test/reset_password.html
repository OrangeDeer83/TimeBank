<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>重設密碼</title>
    <script type="text/javascript">
        function reset_password(){
            pw = document.getElementById("userPassword").value;
            pw_2 = document.getElementById("userPassword_2").value;
            if (pw != pw_2) {
                alert("密碼不一致");
            }
            else{
                website = (window.location.pathname).split(/((?<=\/reset_password_page\/).+)$/g);
                token = website[1];
                var xhr = new XMLHttpRequest();
                xhr.open("POST", "{{url_for('test.user_reset_password', token='')}}" + token);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.send(JSON.stringify({"token": token, "userPassword": pw, "type": 1}));
                xhr.onload = function(){
                    console.log(xhr.responseText)
                    rsp = JSON.parse(xhr.responseText)
                    if (rsp.rspCode = "200") {
                        alert("密碼已重置");
                    }
                    else{
                        alert("密碼重置失敗，請再試一次");
                    }
                }
            }
            
        }
    </script>
</head>
<body>
新密碼<input type="password" id="userPassword" />
確認密碼<input type="password" id="userPassword_2" />
<input type="submit" value="送出" onclick="reset_password();" />
</body>
</html>